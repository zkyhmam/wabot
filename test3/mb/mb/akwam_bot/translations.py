# -*- coding: utf-8 -*-

# --- Translations ---
LANGUAGES = {
    "en": {
        # General
        "start": "Welcome {mention} to the Akwam Bot!\nUse the buttons below or send a movie/series name to search.",
        "help": "Send me the name of a movie or series to search on Akwam.\n\n**Points System:**\n- Daily Limit: {daily_limit} points.\n- Movie Download: {movie_cost} points.\n- Episode Download: {episode_cost} points.\n\n**Referrals:**\nShare your link: `{ref_link}`\nEarn {ref_points} permanent points for each new user who joins via your link!\nReach {ref_target} referrals to get 1 month of Premium for free!",
        "about": "This bot helps you find and download content from Akwam (ak.sv).\nDeveloped by @{admin_username}.\n\n*Disclaimer: This bot is for educational purposes only. Please respect copyright laws.*",
        "error_generic": "❌ An error occurred. Please try again later.",
        "error_fetching": "❌ Error fetching data from the website. It might be down or blocking requests.",
        "cancelled": "Action cancelled.",
        "back": "🔙 Back",
        "yes": "✅ Yes",
        "no": "❌ No",
        "not_implemented": "Action not implemented yet.",
        "no_links": "⚠️ No Download Links Found",
        "choose_language": "🌐 Choose Language",
        "language_set": "Language set to English 🇬🇧",
        "prev": "⬅️ Previous",
        "next": "Next ➡️",
        "page": "Page",
        "search": "Search",
        "movies": "🎬 Movies",
        "series": "📺 Series",
        "points_info": "📊 **Your Points**\n\n**Daily:** {daily_points} / {daily_limit} (Resets {reset_time})\n**Referral:** {ref_points} points\nEarn more by inviting friends!",
        "help_button": "❓ Help",
        "about_button": "ℹ️ About",
        "contact_admin": "👨‍💻 Contact Admin",
        "premium_prompt": "✨ **Go Premium!** ✨\nEnjoy higher limits, faster downloads, and no waiting!\nContact @{admin_username} to subscribe.",
        "points_depleted_prompt": "⚠️ You've used your daily points ({limit}).\n\nShare your referral link to earn permanent points or contact @{admin_username} for Premium!",
        "referral_points_depleted_prompt": "⚠️ You've used all your daily and referral points.\n\nShare your referral link to earn more or contact @{admin_username} for Premium!",
        "monthly_limit_reached": "⚠️ You've reached your monthly download limit ({limit} points). Contact @{admin_username} to upgrade your plan.",
        "premium_expires": "🌟 Premium active until: {expiry_date}",
        # Search
        "searching": "🔎 Searching for \"**{query}**\"...",
        "search_results_title": "🔍 Search Results for \"**{query}**\" ({page}/{total_pages}):",
        "search_no_results": "😕 No results found for \"**{query}**\". Try a different name.",
        "invalid_page": "Invalid page number.",
        # Details
        "details_fetching": "⏳ Fetching details...",
        "details_error": "❌ Error fetching details.",
        "parsing_error": "❌ Error parsing details.",
        "genres": "Genres",
        "description": "Description",
        "no_description": "No description available.",
        "trailer": "🎬 Watch Trailer",
        "select_quality": "⬇️ Select Quality to Download:",
        "episodes": "Episodes",
        # Download
        "download_starting": "⏳ Preparing download...",
        "download_starting_queued": "⏳ Preparing download... You are #{position} in the queue.",
        "download_fetching_links": "⏳ Extracting download link...",
        "download_step1": "**Step 1/3:** Accessing gateway link...",
        "download_step2": "**Step 2/3:** Accessing download page...",
        "download_step3": "**Step 3/3:** Parsing final link...",
        "download_step3_delay": "**Step 3/3:** Detected delay. Waiting...",
        "download_link_error_gateway": "❌ Error accessing gateway link (go.ak.sv).",
        "download_link_error_parse_gateway": "❌ Error parsing gateway page.",
        "download_link_error_page": "❌ Error accessing final download page.",
        "download_link_error_parse_page": "❌ Error parsing final download page. Link not found.",
        "download_link_found": "✅ Direct link found. Starting download...",
        "download_starting_progress": "📥 Starting download...",
        "download_progress": "**Downloading**\n[{bar}] {percent:.1f}%\n{current} / {total}\nSpeed: {speed}/s | ETA: {eta}",
        "download_complete": "⬆️ Download complete. Starting upload...",
        "upload_progress": "**Uploading**\n[{bar}] {percent:.1f}%\n{current} / {total}\nSpeed: {speed}/s | ETA: {eta}",
        "upload_complete": "✅ Upload complete!",
        "download_cancelled": "🗑️ Download cancelled.",
        "download_failed": "❌ Download failed: {error}",
        "download_failed_no_points": "❌ Download failed: Not enough points.",
        "download_already_active": "⚠️ You already have an active download or are in the queue. Please wait or cancel the current one.",
        "checking_archive": "🔍 Checking archive...",
        "found_in_archive": "✅ Found in archive. Sending...",
        "archive_copy_failed": "⚠️ Found in archive, but failed to send. Re-downloading...",
        "uploading_to_archive": "⬆️ Uploading to archive channel...",
        "archive_upload_failed": "❌ Failed to upload to archive channel.",
        "cancel_download_button": "❌ Cancel",
        # Queue
        "queue_position": "You are position #{position} in the download queue.",
        "queue_processing": "Processing queue item for user {user_id}",
        "queue_finished": "Finished queue item for user {user_id}",
        "queue_error": "Error in queue processor: {e}",
        # Mandatory Join
        "mandatory_join_msg": "⚠️ Please join the following channel(s) to use the bot:",
        "join_channel_button": "Join {channel_name}",
        "join_check_button": "✅ I Have Joined",
        "checking_channel_membership": "⏳ Checking membership...",
        # Referral Notifications
        "ref_notification_title": "🎉 New Referral!",
        "ref_notification_body": "{new_user_mention} joined using your link!\n+ {points} Referral Points ✨\nTotal Referrals: {total_referrals}\nTotal Referral Points: {total_ref_points}",
        "premium_referral_notification": "🏆 Congratulations! You reached {count} referrals and earned **1 Month of Premium**!\nExpires: {expiry_date}",
        # Admin
        "admin_panel_button": "⚙️ Admin Panel",
        "admin_panel_title": "⚙️ Admin Panel",
        "add_channel": "➕ Add Channel",
        "remove_channel": "➖ Remove Channel",
        "grant_premium": "⭐ Grant Premium",
        "revoke_premium": "🚫 Revoke Premium",
        "add_points": "💰 Add Points",
        "ban_user": "🔨 Ban User",
        "unban_user": "🔓 Unban User",
        "view_users": "👤 View User",
        "list_banned": "📜 List Banned",
        "add_channel_prompt": "Send the Channel ID or Username (e.g., -100123... or @channel_username):",
        "channel_added": "✅ Channel added successfully.",
        "channel_removed": "✅ Channel removed successfully.",
        "channel_invalid": "❌ Invalid Channel ID/Username or Bot cannot access it.",
        "no_channels_to_remove": "ℹ️ No mandatory channels set.",
        "remove_channel_prompt": "Select a channel to remove:",
        "grant_premium_prompt_user": "Send the User ID or Username to grant premium:",
        "grant_premium_prompt_duration": "Send the duration in days:",
        "premium_granted": "✅ Premium granted to {user} for {days} days.",
        "premium_revoked": "✅ Premium revoked for {user}.",
        "revoke_premium_prompt": "Send the User ID or Username to revoke premium:",
        "add_points_prompt_user": "Send the User ID or Username to add points:",
        "add_points_prompt_amount": "Send the amount of referral points to add:",
        "points_added": "✅ Added {points} referral points to {user}.",
        "ban_user_prompt": "Send the User ID or Username to ban:",
        "ban_confirm": "Are you sure you want to ban {user}?",
        "user_banned": "✅ {user} has been banned.",
        "unban_user_prompt": "Send the User ID or Username to unban:",
        "unban_confirm": "Are you sure you want to unban {user}?",
        "user_unbanned": "✅ {user} has been unbanned.",
        "user_not_found": "❌ User not found or hasn't started the bot.",
        "user_not_banned": "ℹ️ User is not banned.",
        "user_search_prompt": "Send the User ID or Username to view info:",
        "user_info": """**User Info:**
🆔 User ID: `{user_id}`
👤 Name: {name}
🔗 Username: @{username}
🗣️ Language: {lang}
📊 Daily Points: {daily_p}/{daily_l}
💰 Referral Points: {ref_p} ({ref_c} referrals)
⭐ Premium Until: {premium_u}
🔨 Banned: {banned}""",
        "no_banned_users": "ℹ️ No users are currently banned.",
        "banned_users_list": "📜 Banned Users (Page {page}/{total_pages}):",
        "invalid_input": "❌ Invalid input.",
        # Startup
        "archive_admin_error": "⚠️ FATAL: Bot must be an admin with 'Post Messages' permission in the archive channel ({channel_id}) to function correctly. Please promote the bot and restart.",
        "archive_check_error": "⚠️ FATAL: Could not verify admin status in archive channel ({channel_id}). Ensure the ID is correct and the bot is added to the channel.",
        # Add Arabic translations here, same structure...
    },
    "ar": {
        # General
        "start": "أهلاً بك {mention} في بوت أكوام!\nاستخدم الأزرار بالأسفل أو أرسل اسم فيلم/مسلسل للبحث.",
        "help": "أرسل لي اسم الفيلم أو المسلسل للبحث في أكوام.\n\n**نظام النقاط:**\n- الحد اليومي: {daily_limit} نقطة.\n- تحميل فيلم: {movie_cost} نقطة.\n- تحميل حلقة مسلسل: {episode_cost} نقطة.\n\n**نظام الإحالة:**\nشارك رابطك: `{ref_link}`\nاكسب {ref_points} نقطة دائمة لكل مستخدم جديد ينضم عبر رابطك!\nاجمع {ref_target} إحالة لتحصل على شهر بريميوم مجاناً!",
        "about": "هذا البوت يساعدك في البحث وتحميل المحتوى من أكوام (ak.sv).\nتطوير @{admin_username}.\n\n*إخلاء مسؤولية: هذا البوت للأغراض التعليمية فقط. يرجى احترام قوانين حقوق النشر.*",
        "error_generic": "❌ حدث خطأ. يرجى المحاولة مرة أخرى لاحقًا.",
        "error_fetching": "❌ خطأ في جلب البيانات من الموقع. قد يكون الموقع معطلاً أو يحظر الطلبات.",
        "cancelled": "تم إلغاء الإجراء.",
        "back": "🔙 رجوع",
        "yes": "✅ نعم",
        "no": "❌ لا",
        "not_implemented": "الإجراء غير متاح بعد.",
        "no_links": "⚠️ لم يتم العثور على روابط تحميل",
        "choose_language": "🌐 اختر اللغة",
        "language_set": "تم ضبط اللغة إلى العربية 🇪🇬",
        "prev": "⬅️ السابق",
        "next": "التالي ➡️",
        "page": "صفحة",
        "search": "بحث",
        "movies": "🎬 أفلام",
        "series": "📺 مسلسلات",
        "points_info": "📊 **نقاطك**\n\n**اليومية:** {daily_points} / {daily_limit} (تتجدد {reset_time})\n**الإحالة:** {ref_points} نقطة\nاكسب المزيد بدعوة أصدقائك!",
        "help_button": "❓ مساعدة",
        "about_button": "ℹ️ حول",
        "contact_admin": "👨‍💻 تواصل مع المطور",
        "premium_prompt": "✨ **احصل على البريميوم!** ✨\nاستمتع بحدود أعلى، تحميل أسرع، وبدون انتظار!\nتواصل مع @{admin_username} للاشتراك.",
        "points_depleted_prompt": "⚠️ لقد استهلكت نقاطك اليومية ({limit}).\n\nشارك رابط الإحالة الخاص بك لكسب نقاط دائمة أو تواصل مع @{admin_username} للحصول على البريميوم!",
        "referral_points_depleted_prompt": "⚠️ لقد استهلكت جميع نقاطك اليومية ونقاط الإحالة.\n\nشارك رابط الإحالة الخاص بك لكسب المزيد أو تواصل مع @{admin_username} للحصول على البريميوم!",
        "monthly_limit_reached": "⚠️ لقد وصلت إلى حد التحميل الشهري ({limit} نقطة). تواصل مع @{admin_username} لترقية خطتك.",
        "premium_expires": "🌟 البريميوم مفعل حتى: {expiry_date}",
        # Search
        "searching": "🔎 جاري البحث عن \"**{query}**\"...",
        "search_results_title": "🔍 نتائج البحث عن \"**{query}**\" ({page}/{total_pages}):",
        "search_no_results": "😕 لم يتم العثور على نتائج لـ \"**{query}**\". جرب اسمًا مختلفًا.",
        "invalid_page": "رقم الصفحة غير صالح.",
        # Details
        "details_fetching": "⏳ جاري جلب التفاصيل...",
        "details_error": "❌ خطأ في جلب التفاصيل.",
        "parsing_error": "❌ خطأ في تحليل التفاصيل.",
        "genres": "الأنواع",
        "description": "الوصف",
        "no_description": "لا يوجد وصف متاح.",
        "trailer": "🎬 مشاهدة الإعلان",
        "select_quality": "⬇️ اختر الجودة للتحميل:",
        "episodes": "الحلقات",
        # Download
        "download_starting": "⏳ جاري تحضير التحميل...",
        "download_starting_queued": "⏳ جاري تحضير التحميل... أنت رقم #{position} في طابور الانتظار.",
        "download_fetching_links": "⏳ جاري استخراج رابط التحميل...",
        "download_step1": "**الخطوة 1/3:** الوصول إلى رابط البوابة...",
        "download_step2": "**الخطوة 2/3:** الوصول إلى صفحة التحميل...",
        "download_step3": "**الخطوة 3/3:** تحليل الرابط النهائي...",
        "download_step3_delay": "**الخطوة 3/3:** تم اكتشاف تأخير. جاري الانتظار...",
        "download_link_error_gateway": "❌ خطأ في الوصول لرابط البوابة (go.ak.sv).",
        "download_link_error_parse_gateway": "❌ خطأ في تحليل صفحة البوابة.",
        "download_link_error_page": "❌ خطأ في الوصول لصفحة التحميل النهائية.",
        "download_link_error_parse_page": "❌ خطأ في تحليل صفحة التحميل النهائية. لم يتم العثور على الرابط.",
        "download_link_found": "✅ تم العثور على الرابط المباشر. بدء التحميل...",
        "download_starting_progress": "📥 بدء التحميل...",
        "download_progress": "**جاري التحميل**\n[{bar}] {percent:.1f}%\n{current} / {total}\nالسرعة: {speed}/ث | الوقت المتبقي: {eta}",
        "download_complete": "⬆️ اكتمل التحميل. بدء الرفع...",
        "upload_progress": "**جاري الرفع**\n[{bar}] {percent:.1f}%\n{current} / {total}\nالسرعة: {speed}/ث | الوقت المتبقي: {eta}",
        "upload_complete": "✅ اكتمل الرفع!",
        "download_cancelled": "🗑️ تم إلغاء التحميل.",
        "download_failed": "❌ فشل التحميل: {error}",
        "download_failed_no_points": "❌ فشل التحميل: لا توجد نقاط كافية.",
        "download_already_active": "⚠️ لديك بالفعل تحميل نشط أو أنت في قائمة الانتظار. يرجى الانتظار أو إلغاء التحميل الحالي.",
        "checking_archive": "🔍 جاري فحص الأرشيف...",
        "found_in_archive": "✅ موجود في الأرشيف. جاري الإرسال...",
        "archive_copy_failed": "⚠️ موجود في الأرشيف، لكن فشل الإرسال. إعادة التحميل...",
        "uploading_to_archive": "⬆️ جاري الرفع إلى قناة الأرشيف...",
        "archive_upload_failed": "❌ فشل الرفع إلى قناة الأرشيف.",
        "cancel_download_button": "❌ إلغاء",
        # Queue
        "queue_position": "أنت رقم #{position} في طابور التحميل.",
        "queue_processing": "معالجة عنصر الطابور للمستخدم {user_id}",
        "queue_finished": "انتهاء معالجة عنصر الطابور للمستخدم {user_id}",
        "queue_error": "خطأ في معالج الطابور: {e}",
        # Mandatory Join
        "mandatory_join_msg": "⚠️ يرجى الانضمام إلى القناة/القنوات التالية لاستخدام البوت:",
        "join_channel_button": "انضم إلى {channel_name}",
        "join_check_button": "✅ لقد انضممت",
        "checking_channel_membership": "⏳ جاري التحقق من العضوية...",
        # Referral Notifications
        "ref_notification_title": "🎉 إحالة جديدة!",
        "ref_notification_body": "{new_user_mention} انضم باستخدام رابطك!\n+ {points} نقطة إحالة ✨\nإجمالي الإحالات: {total_referrals}\nإجمالي نقاط الإحالة: {total_ref_points}",
        "premium_referral_notification": "🏆 تهانينا! لقد وصلت إلى {count} إحالة وحصلت على **شهر بريميوم مجاني**!\nينتهي في: {expiry_date}",
        # Admin
        "admin_panel_button": "⚙️ لوحة التحكم",
        "admin_panel_title": "⚙️ لوحة التحكم",
        "add_channel": "➕ إضافة قناة",
        "remove_channel": "➖ إزالة قناة",
        "grant_premium": "⭐ منح بريميوم",
        "revoke_premium": "🚫 إلغاء بريميوم",
        "add_points": "💰 إضافة نقاط",
        "ban_user": "🔨 حظر مستخدم",
        "unban_user": "🔓 إلغاء حظر",
        "view_users": "👤 عرض مستخدم",
        "list_banned": "📜 قائمة المحظورين",
        "add_channel_prompt": "أرسل معرف القناة أو اسم المستخدم (مثل -100123... أو @channel_username):",
        "channel_added": "✅ تم إضافة القناة بنجاح.",
        "channel_removed": "✅ تم إزالة القناة بنجاح.",
        "channel_invalid": "❌ معرف/اسم مستخدم قناة غير صالح أو لا يمكن للبوت الوصول إليه.",
        "no_channels_to_remove": "ℹ️ لا توجد قنوات اشتراك إجباري محددة.",
        "remove_channel_prompt": "اختر قناة لإزالتها:",
        "grant_premium_prompt_user": "أرسل معرف المستخدم أو اسم المستخدم لمنحه البريميوم:",
        "grant_premium_prompt_duration": "أرسل المدة بالأيام:",
        "premium_granted": "✅ تم منح البريميوم لـ {user} لمدة {days} يوم.",
        "premium_revoked": "✅ تم إلغاء البريميوم لـ {user}.",
        "revoke_premium_prompt": "أرسل معرف المستخدم أو اسم المستخدم لإلغاء البريميوم:",
        "add_points_prompt_user": "أرسل معرف المستخدم أو اسم المستخدم لإضافة النقاط:",
        "add_points_prompt_amount": "أرسل كمية نقاط الإحالة المراد إضافتها:",
        "points_added": "✅ تم إضافة {points} نقطة إحالة إلى {user}.",
        "ban_user_prompt": "أرسل معرف المستخدم أو اسم المستخدم لحظره:",
        "ban_confirm": "هل أنت متأكد من رغبتك في حظر {user}؟",
        "user_banned": "✅ تم حظر {user}.",
        "unban_user_prompt": "أرسل معرف المستخدم أو اسم المستخدم لإلغاء الحظر:",
        "unban_confirm": "هل أنت متأكد من رغبتك في إلغاء حظر {user}؟",
        "user_unbanned": "✅ تم إلغاء حظر {user}.",
        "user_not_found": "❌ المستخدم غير موجود أو لم يبدأ البوت بعد.",
        "user_not_banned": "ℹ️ المستخدم ليس محظوراً.",
        "user_search_prompt": "أرسل معرف المستخدم أو اسم المستخدم لعرض المعلومات:",
        "user_info": """**معلومات المستخدم:**
🆔 المعرف: `{user_id}`
👤 الاسم: {name}
🔗 اسم المستخدم: @{username}
🗣️ اللغة: {lang}
📊 النقاط اليومية: {daily_p}/{daily_l}
💰 نقاط الإحالة: {ref_p} ({ref_c} إحالات)
⭐ بريميوم حتى: {premium_u}
🔨 محظور: {banned}""",
        "no_banned_users": "ℹ️ لا يوجد مستخدمون محظورون حاليًا.",
        "banned_users_list": "📜 المستخدمون المحظورون (صفحة {page}/{total_pages}):",
        "invalid_input": "❌ إدخال غير صالح.",
         # Startup
        "archive_admin_error": "⚠️ خطأ فادح: يجب أن يكون البوت مشرفًا بصلاحية 'نشر الرسائل' في قناة الأرشيف ({channel_id}) ليعمل بشكل صحيح. يرجى ترقية البوت وإعادة التشغيل.",
        "archive_check_error": "⚠️ خطأ فادح: تعذر التحقق من حالة المشرف في قناة الأرشيف ({channel_id}). تأكد من صحة المعرف وإضافة البوت إلى القناة.",
    }
}
DEFAULT_LANG = "en"

def get_text(lang: str, key: str, default: str = None) -> str:
    """Retrieves text from the translation dictionary with fallback."""
    # Fallback to English if lang not found
    lang_dict = LANGUAGES.get(lang, LANGUAGES[DEFAULT_LANG])
    # Fallback to default string or key if key not found
    return lang_dict.get(key, default or f"[{key}]")
